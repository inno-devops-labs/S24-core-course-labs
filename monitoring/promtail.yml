server:
  http_listen_port: 9080
  grpc_listen_port: 0

client:
  url: http://loki:3100/api/prom/push

positions:
  filename: /tmp/positions.yaml

scrape_configs:
  - job_name: flog_scrape
    docker_sd_configs:
      - host: unix:///var/run/docker.sock
        refresh_interval: 30s
    relabel_configs:
      - source_labels: ['__meta_docker_container_name']
        regex: '/(.*)'
        target_label: 'container'

  # - job_name: flog_scrape
  #   docker_sd_configs:
  #     - host: unix:///var/run/docker.sock
  #       refresh_interval: 5s
  #       filters:
  #         - name: label
  #           values: ["logging=promtail"]
  #   relabel_configs:
  #     - source_labels: ['__meta_docker_container_name']
  #       regex: '/(.*)'
  #       target_label: 'container'
  #     - source_labels: ['__meta_docker_container_log_stream']
  #       target_label: 'logstream'
  #     - source_labels: ['__meta_docker_container_label_logging_jobname']
  #       target_label: 'job'
  # # - job_name: containers
  # #
  # #   docker_sd_configs:
  # #     - host: unix:///var/run/docker.sock
  # #       labels:
  # #         - job: docker
  # #       refresh_interval: 5s
  # #
  # #   # static_configs:
  # #   #   - targets:
  # #   #       - localhost
  # #   #     labels:
  # #   #       job: docker
  # #   #       __path__: /var/lib/docker/containers/*/*log
  # #
  #   pipeline_stages:
  #     - json:
  #         expressions:
  #           stream: stream
  #           attrs: attrs
  #           tag: attrs.tag
  #           time: time
  #     - timestamp:
  #         source: time
  #         format: RFC3339Nano
  #     - regex:
  #         expression: ^(?P<image_name>([^|]+))\|(?P<container_name>([^|]+))$
  #         source: "tag"
  #     - labels:
  #         image_name:
  #         container_name:
